<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<link
			rel="stylesheet"
			href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css"
			integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M"
			crossorigin="anonymous"
		/>
		<script src="https://www.google.com/recaptcha/api.js"></script>
		<style>
			body {
				background-color: #343233;
			}
			.align {
				margin: 10% auto;
				width: 50%;
			}
		</style>
		<title>Compliment Generator ðŸ¥°</title>
	</head>

	<body>
		<div class="container align">
			<h1 style="color: #ffd152;">Compliment Generator ðŸ¥°</h1>
			<form id="subscribeForm">
				<div class="form-group">
					<label style="color: #ffd152;" for="name">Name</label>
					<input
						type="text"
						style="
							border-color: #efdab9;
							color: #efdab9;
							background: transparent;
						"
						name="name"
						placeholder="Name"
						id="name"
						class="form-control"
					/>
				</div>
				<!-- <div class="form-group">
          <label for="email">Email</label>
          <input type="text" name="email" id="email" class="form-control" />
        </div> -->
				<div class="form-group">
					<div
						class="g-recaptcha"
						data-sitekey="6LdwA6YZAAAAAGA99eJ4q6lS-bLmQcgCxXodWYOG"
					></div>
				</div>
				<input
					style="cursor: pointer; background-color: #ffd152; color: #343233;"
					type="submit"
					value="Generate Compliment"
					class="btn"
				/>
			</form>
			<div id="compliment"></div>
		</div>

		<script>
			document
				.getElementById('subscribeForm')
				.addEventListener('submit', (e) => {
					e.preventDefault();

					const name = document.querySelector('#name').value;
					const captcha = document.querySelector('#g-recaptcha-response').value;
					const compliment = document.querySelector('#compliment');

					return fetch('/subscribe', {
						method: 'POST',
						headers: { 'Content-type': 'application/json' },
						body: JSON.stringify({ name, captcha }),
					})
						.then((res) => res.json())
						.then((data) => {
							if (!data.success) alert(data.msg);
							if (typeof data.compliment !== 'undefined') {
								compliment.innerHTML = data.compliment;
							}
						});
				});
		</script>
	</body>
</html>
